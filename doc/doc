Портативный цифровой осциллограф
===============
Устройство используется для анализа характера аналоговых сигналов. Сигнал отображается в реальном времени, с помощью изменения частоты дискретизации можно получить стабилизованное изображение.
Также доступен просмотр спектра сигнала и режим XY.

Подключение
===============
МК ATmega644 - PORTA PORTC PORTD
PORTA 0	Вход сигнала 1 (по умолчанию)
PORTA 1	Вход сигнала 2
PORTA 2	Через кнопку "вверх" на землю (нажато - замкнуто)
PORTA 3 кнопка вправо
PORTA 4 кнопка влево
PORTA 5 кнопка пауза отрисовки
PORTA 6 кнопка вверх
PORTA 7 кнопка вниз

Дисплей
------------------
Настроить пины дисплея можно в файле lcd.c
Дисплей 20 пинов (1-20)
LCD	MK/шина
1	GND
2	VCC +5V
3	средняя ножка переменного резистора. две другие подключить к земле и 18 ножке дисплея
4	PORTD 5
5	PORTD 4
6	PORTD 6
7	PORTC 0
8	PORTC 1
9	PORTC 2
...
14	PORTC 7
15	PORTD 2
16	PORTD 3
17	PORTD 7
18	К одной из ножек переменного резистора (см. ножку 3 дисплея)
19	Питание подсветки. Подключать к +5V через резистор 17 Ом
20	GND


Пункты меню
===============
- EXIT вернуться к просмотру данных (сигнала/спектра... в зависимости от режима работы)
- MODE выбор режима работы
- ADC PERIOD настройка периода ацп (величина, обратная частоте). Измеряется в тактах
- ADC CHECK количество проверяемых точек (для "развертки")
- ADC ERROR максимальное расхождение, погрешность
- ADC STEP настройка шага изменения частоты дискретизации при просмотре сигнала (кнопки вправо и влево)
- LCD SKIP пропуск N раз отрисовки (для спектра и сигнала) / пропуск N стираний экрана (для режима XY)
- SP. XZOOM/SP. YZOOM увеличение масштаба спектра

Режимы работы
===============
- SIGNAL показывает сигнал с АЦП в реальном времени. Для получения стабилизованного изображения сигнала изменяется частота дискретизации.
- SPECTRUM спектр сигнала в реальном времени. Левая колонка спектра - 0 "нулевая частота", частота последней отображается в меню или в режиме паузы
- DUAL одновременно сигнал (слева) и спектр. Описание для каждого в соответствующих пунктах
- XY рисуются точки (u1,u2). В некоторый момент времени t напряжение на ADC0 = u1, а на ADC1 u2. Используется для получения фигур Лиссажу.
- UART для работы с компьютером по протоколу UART. Данные отсылаются на компьютер по одному байту на измерение. *beta*
- UART BUF буферизованный режим работы с компьютером. Сначала накапливается ALL_N измерений, а после они передаются на компьютер. Можно менять частоту дискретизации *beta*

Код
===============

Глобальные переменные
------------------
- ADC_PERIOD - задает время между двумя измерениями АЦП. 1/ADC_PERIOD - частота дискретизации
- menu_state - состояние меню.
- - -1 выключено
- - 0 "выйти"
- - 1...MENU_MAX - пункты меню
- - MENU_MAX+1...2*MENU_MAX - внутри пункта меню 1...MENU_NAX
- array_filled показывает, что массив измерений capture заполнен и в следующий раз необходимо ждать того момента, когда сигнал станет похожим на начало первого (чтобы обеспечить стабилизованное изображение)
- adc_check сколько измерений проверять на расхождение с предыдущим набором измерений (см. array_filled)
- adc_error максимальное расхождение (см. adc_check)

main
------------------
В main происходит отрисовка. Если redraw_menu!=0, то прроходит рисование меню.
Как только current становится равен ALL_N-1, сбор данных с ацп останавливается, рисуется сигнал.
По окончанию счетчик current сбрасывается на 0.

Прерывание по TIMER1_COMPB
------------------
Запускает АЦ преобразование. Таймер настроен на выполнение с заданной частотой 1/ADC_PERIOD

Прерывание по ADC
------------------
Сохраняет полученное от АЦП измерение, если current<ALL_N.
В режиме XY здесь меняется регистр ADMUX таким образом, чтобы измерения проводились последовательно: одно с ADC0, следующее - с ADC1. При четных current также производится запрос следующего измерения (со второго канала).


Прерывание по TIMER1_COMPB
------------------
Проверяет состояние кнопок и меняет параметры программы - ADC_PERIOD, menu_state etc
